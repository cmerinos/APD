% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/APDmg.R, R/iiacor.R
\name{iiacor}
\alias{iiacor}
\title{Average Inter-Item Correlation with Bootstrap CI}
\usage{
iiacor(
  data,
  rmethod = "pearson",
  conf.level = 0.95,
  nboot = 1000,
  bmethod = "bca",
  nd = 3,
  group = NULL
)

iiacor(
  data,
  rmethod = "pearson",
  conf.level = 0.95,
  nboot = 1000,
  bmethod = "bca",
  nd = 3,
  group = NULL
)
}
\arguments{
\item{data}{A \code{data.frame} of numeric item responses. Rows are observations, columns are items.}

\item{rmethod}{Character. Correlation method: \code{"pearson"} (default) or \code{"spearman"}.}

\item{conf.level}{Numeric. Confidence level for the interval (default = \code{0.95}).}

\item{nboot}{Integer. Number of bootstrap samples for CI computation (default = \code{1000}).}

\item{bmethod}{Character. Bootstrap CI method: \code{"bca"} (bias-corrected and accelerated),
\code{"perc"} (percentile), or \code{"norm"} (normal approximation). Default = \code{"bca"}.}

\item{nd}{Integer. Number of decimal digits to round results (default = \code{3}).}

\item{group}{Optional vector indicating group membership (factor, character, or numeric).
If supplied, group-wise iia will be calculated and pairwise differences between groups
will be reported.}
}
\value{
A list with two components:
\itemize{
  \item \code{group_results}: A \code{data.frame} containing, for each group:
  \itemize{
    \item \code{group}: Group label.
    \item \code{avg_r}: Average inter-item correlation (back-transformed from Fisher's z).
    \item \code{lwr.ci}, \code{upr.ci}: Lower and upper bounds of the bootstrap confidence interval.
    \item \code{min}, \code{max}: Minimum and maximum inter-item correlations in the matrix.
    \item \code{sd}: Standard deviation of inter-item correlations.
  }

  \item \code{comparisons}: A \code{data.frame} containing all pairwise comparisons between groups:
  \itemize{
    \item \code{group1}, \code{group2}: The groups being compared.
    \item \code{diff}: Difference in average inter-item correlations
      (\code{avg_r_group1 - avg_r_group2}).
    \item \code{lwr.ci}, \code{upr.ci}: MOVER-type confidence interval limits for the difference.
  }
  If only one group is present (or \code{group = NULL}), \code{comparisons} is returned as an
  empty \code{data.frame}.
}

A list with three components:
\itemize{
  \item \code{group_results}: A \code{data.frame} containing, for each group:
  \itemize{
    \item \code{group}: Group label.
    \item \code{avg_r}: Average inter-item correlation (back-transformed from Fisher's z).
    \item \code{lwr.ci}, \code{upr.ci}: Lower and upper bounds of the bootstrap confidence interval.
    \item \code{min}, \code{max}: Minimum and maximum inter-item correlations in the matrix.
    \item \code{sd}: Standard deviation of inter-item correlations.
  }

  \item \code{comparisons}: A \code{data.frame} containing all pairwise comparisons between groups:
  \itemize{
    \item \code{group1}, \code{group2}: The groups being compared.
    \item \code{diff}: Difference in average inter-item correlations
      (\code{avg_r_group1 - avg_r_group2}).
    \item \code{lwr.ci}, \code{upr.ci}: MOVER-type confidence interval limits for the difference.
    \item \code{z}: Wald-type test statistic for the difference.
    \item \code{p.value}: Two-sided p-value associated with the Wald statistic.
  }

  \item \code{global_test}: A \code{data.frame} with a single row (labelled \code{"test"})
  summarizing the fixed-effects homogeneity test across all groups:
  \itemize{
    \item \code{Q}: Cochran-type Q statistic for homogeneity of the group-specific iia values.
    \item \code{df}: Degrees of freedom (\code{G - 1}, where \code{G} is the number of groups).
    \item \code{p.value}: p-value for the Q statistic under the chi-square approximation.
    \item \code{I2}: Percentage of heterogeneity (\eqn{I^2}), expressing the proportion of
      between-group variability beyond sampling error (in \%).
    \item \code{k}: Number of groups included in the test.
    \item \code{pooled}: Fixed-effect pooled estimate of the average inter-item correlation.
  }
  If only one group is present (or \code{group = NULL}), \code{comparisons} is returned as an
  empty \code{data.frame}, and the fields in \code{global_test} are provided for completeness
  but the homogeneity test is not meaningful.
}
}
\description{
Computes the average inter-item correlation (iia) for a set of items, with optional bootstrap
confidence intervals. It supports Pearson or Spearman correlations and allows grouped analysis.
Fisher's z-transformation is used to average correlations appropriately. When groups are provided,
the function also computes MOVER-type confidence intervals for the difference in iia between
all pairs of groups.

Computes the average inter-item correlation (iia) for a set of items, with optional bootstrap
confidence intervals. It supports Pearson or Spearman correlations and allows grouped analysis.
Fisher's z-transformation is used to average correlations appropriately. When groups are provided,
the function also computes MOVER-type confidence intervals and Wald-type tests for the difference
in iia between all pairs of groups, as well as a global test of homogeneity across groups.
}
\details{
For each group, the function estimates the inter-item correlation matrix, extracts the lower-triangular
elements, and averages them after applying Fisher's \eqn{z = \mathrm{arctanh}(r)} transformation.
Bootstrap resampling is performed on the Fisher z values, and the resulting confidence intervals
are back-transformed to the correlation metric.

When more than one group is present, pairwise differences in average inter-item correlations are
summarized using a simple MOVER-type (Method Of Variance Estimates Recovery) confidence interval.
The MOVER approach combines two confidence intervals into a confidence interval for the difference
between the corresponding estimates, using only the endpoints of the original intervals.

For each group, the function estimates the inter-item correlation matrix, extracts the lower-triangular
elements, and averages them after applying Fisher's transformation \eqn{z = \mathrm{arctanh}(r)}.
Bootstrap resampling is performed on the Fisher z values, and the resulting confidence intervals
are back-transformed to the correlation metric.

When more than one group is present, two types of inferential summaries are provided:

\strong{(1) Global test of homogeneity (Q statistic, fixed-effects framework).}

Let \eqn{\hat{\theta}_g} denote the average inter-item correlation (iia) for group \eqn{g}, and let
\eqn{[L_g, U_g]} be its confidence interval at level \code{conf.level}. An approximate standard error
for each group is obtained by assuming a normal-based interval:
\deqn{
\mathrm{SE}_g \approx \frac{U_g - L_g}{2 z_{1-\alpha/2}},
}
where \eqn{\alpha = 1 - \text{conf.level}} and \eqn{z_{1-\alpha/2}} is the corresponding standard normal
quantile. The within-group variances are then \eqn{V_g = \mathrm{SE}_g^2}, and fixed-effect weights are
defined as \eqn{w_g = 1 / V_g}.

A pooled (fixed-effect) average inter-item correlation is computed as
\deqn{
\hat{\theta}_{\mathrm{pooled}} =
  \frac{\sum_g w_g \hat{\theta}_g}{\sum_g w_g}.
}

The Cochran-type Q statistic for testing homogeneity of the group-specific iia values is
\deqn{
Q = \sum_g w_g (\hat{\theta}_g - \hat{\theta}_{\mathrm{pooled}})^2,
}
which is compared to a chi-square distribution with \eqn{G - 1} degrees of freedom, where
\eqn{G} is the number of groups. The null hypothesis is that all groups share the same
underlying average inter-item correlation (fixed-effects perspective).

In addition, a descriptive index of heterogeneity is reported:
\deqn{
I^2 = \max\left(0, \frac{Q - (G-1)}{Q}\right) \times 100,
}
representing the percentage of between-group variability in the iia estimates that exceeds what
would be expected from sampling error alone (within the fixed-effects approximation).

\strong{(2) Pairwise differences between groups (MOVER CI and Wald-type test).}

For each pair of groups \eqn{g_1} and \eqn{g_2}, the function reports the difference in average
inter-item correlations:
\deqn{
D = \hat{\theta}_{g_1} - \hat{\theta}_{g_2}.
}

A MOVER-type (Method Of Variance Estimates Recovery) confidence interval for \eqn{D} is constructed
using only the endpoints of the group-specific confidence intervals \eqn{[L_{g}, U_{g}]}.
For example, one form of the MOVER interval is
\deqn{
\mathrm{CI}_{\Delta}
=
\left[
D \pm
\sqrt{(\hat{\theta}_{g_1} - L_{g_1})^2 + (U_{g_2} - \hat{\theta}_{g_2})^2}
\right],
}
with the complementary limits obtained by swapping the roles of the lower and upper bounds.
This approach combines the uncertainty from both groups without requiring explicit variance
formulas for the difference.

In parallel, a Wald-type test is provided for each pairwise difference. Using the same
approximate standard errors derived from the confidence intervals,
\deqn{
\mathrm{SE}_{g} \approx \frac{U_{g} - L_{g}}{2 z_{1-\alpha/2}},
}
the standard error of the difference is
\deqn{
\mathrm{SE}_{D} = \sqrt{\mathrm{SE}_{g_1}^2 + \mathrm{SE}_{g_2}^2},
}
assuming independence between groups. The Wald statistic is then
\deqn{
z = \frac{D}{\mathrm{SE}_{D}},
}
with a two-sided p-value computed from the standard normal distribution. These Wald p-values and
the MOVER confidence intervals are both based on approximations derived from the group-level
intervals and should be interpreted as exploratory inferential summaries rather than exact tests.
}
\examples{
set.seed(123)

data <- data.frame(
  item1 = rnorm(100),
  item2 = rnorm(100),
  item3 = rnorm(100)
)

# Single-group average inter-item correlation
res1 <- iiacor(data)
res1$group_results

# Two groups with MOVER comparison
grp <- rep(c("A", "B"), each = 50)
res2 <- iiacor(data, rmethod = "spearman", group = grp)
res2$group_results
res2$comparisons

set.seed(123)

data <- data.frame(
  item1 = rnorm(100),
  item2 = rnorm(100),
  item3 = rnorm(100)
)

# Single-group average inter-item correlation
res1 <- iiacor(data)
res1$group_results

# Two groups with MOVER and Wald comparisons plus global test
grp <- rep(c("A", "B"), each = 50)
res2 <- iiacor(data, rmethod = "spearman", group = grp)
res2$group_results
res2$comparisons
res2$global_test

}
\references{
Briggs, S.R. and Cheek, J.M. (1986). The role of factor analysis in the development and evaluation
of personality scales. \emph{Journal of Personality, 54}, 106–148.
https://doi.org/10.1111/j.1467-6494.1986.tb00391.x

Clark, L. A., & Watson, D. (1995). Constructing validity: Basic issues in objective scale development.
\emph{Psychological Assessment, 7}(3), 309–319. https://doi.org/10.1037/1040-3590.7.3.309

Piedmont, R.L. (2014). Inter-item correlations. In A.C. Michalos (Ed.),
\emph{Encyclopedia of Quality of Life and Well-Being Research}. Springer, Dordrecht.
https://doi.org/10.1007/978-94-007-0753-5_1493

Park, J., van den Broek, K. L., Bhullar, N., Ogunbode, C. A., Schermer, J. A., Doran, R., Ardi, R.,
Hanss, D., Maran, D. A., Albzour, M., Aquino, S. D., Ayanian, A. H., Chegeni, R., Chukwuorji,
J. B. C., Enea, V., Ghanbarian, E., Ghorayeb, J., Jiang, F., Kehinde, O. A., ... Yadav, R. (2022).
Comparison of the inter-item correlations of the Big Five Inventory-10 (BFI-10) between Western and
non-Western contexts. \emph{Personality and Individual Differences, 196}, 111751.
https://doi.org/10.1016/j.paid.2022.111751

Briggs, S.R. and Cheek, J.M. (1986). The role of factor analysis in the development and evaluation
of personality scales. \emph{Journal of Personality, 54}, 106–148.
https://doi.org/10.1111/j.1467-6494.1986.tb00391.x

Clark, L. A., & Watson, D. (1995). Constructing validity: Basic issues in objective scale development.
\emph{Psychological Assessment, 7}(3), 309–319. https://doi.org/10.1037/1040-3590.7.3.309

Piedmont, R.L. (2014). Inter-item correlations. In A.C. Michalos (Ed.),
\emph{Encyclopedia of Quality of Life and Well-Being Research}. Springer, Dordrecht.
https://doi.org/10.1007/978-94-007-0753-5_1493

Park, J., van den Broek, K. L., Bhullar, N., Ogunbode, C. A., Schermer, J. A., Doran, R., Ardi, R.,
Hanss, D., Maran, D. A., Albzour, M., Aquino, S. D., Ayanian, A. H., Chegeni, R., Chukwuorji,
J. B. C., Enea, V., Ghanbarian, E., Ghorayeb, J., Jiang, F., Kehinde, O. A., ... Yadav, R. (2022).
Comparison of the inter-item correlations of the Big Five Inventory-10 (BFI-10) between Western and
non-Western contexts. \emph{Personality and Individual Differences, 196}, 111751.
https://doi.org/10.1016/j.paid.2022.111751
}
